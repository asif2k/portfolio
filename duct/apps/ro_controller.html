<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>finally</title>
    <script src="../finally.js"></script>
    <script src="http://localhost:8081/api/ro"></script>
    <style>
        iframe {
            width: 400px;
            height: 400px;
            display: block;
        }

        body {
            overflow: hidden;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap
        }
    </style>
</head>

<body>
    <button onclick="add_client()">Add Client</button>
    <script>
        function add_client() {
            var f = document.createElement("iframe");
            f.src = "ro_client.html";
            document.body.appendChild(f);
        }
        fin.entry(function (fin, ge, math) {
            dependencies([
                ['ecs', '/libs/ecs.js'],
                ['math', '/libs/math.js'],
                ['ge', '/ge/index.js'],


            ]);



            const serv = new ro.controller("http://localhost:8081", "admin", "admin");

            serv.login(function () {
                console.log(serv);

                serv.add_schemas({
                    "player": {
                        "#pos": "float32x3",
                        "#rot": "float32x3"
                    }
                });
                serv.on_data = (function (_super) {

                    return function (data, data_length) {
                        _super.apply(this, [data, data_length]);

                    }

                })(serv.on_data);

                serv.connect("/controller/3d1/3d2", function (ws) {

                    serv.api("set_controller_schemas", { schemas: JSON.stringify(serv.schemas) });

                    serv.begin_updates(50);




                });

            });

        });

    </script>



</body>
</html>